<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دفتر المصروف الذكي - Master Taha</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --top-bg: #0077FF; /* أزرق HD */
            --bottom-bg: #FFFFFF; /* أبيض HD */
            --text-color: #000000; /* أسود HD */
            --primary-color: #0055CC; /* أزرق داكن HD */
            --secondary-color: #28A745; /* أخضر HD */
            --danger-color: #DC3545; /* أحمر HD */
            --warning-color: #FFC107; /* أصفر HD */
            --card-bg: #FFFFFF; /* أبيض HD */
            --border-color: #E0E0E0; /* رمادي فاتح HD */
            --shadow-color: rgba(0, 0, 0, 0.1);
            --hover-shadow: rgba(0, 0, 0, 0.15);
        }
        
        body {
            background: linear-gradient(to bottom, var(--top-bg), var(--bottom-bg));
            color: var(--text-color);
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 25px;
            margin-bottom: 35px;
            background-color: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 6px 18px var(--shadow-color);
            border: 1px solid var(--border-color);
        }
        
        .company-info {
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 18px;
            margin-bottom: 18px;
        }
        
        .company-info h1 {
            color: var(--primary-color);
            font-size: 2.4rem;
            margin-bottom: 12px;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .company-info p {
            font-size: 1.05rem;
            margin: 6px 0;
            color: #333333;
            font-weight: 500;
        }
        
        .mplan-badge {
            background: linear-gradient(135deg, var(--primary-color), #003D99);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.95rem;
            display: inline-block;
            margin-top: 12px;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 87, 255, 0.2);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 25px;
            margin-bottom: 45px;
        }
        
        .panel-card {
            background-color: var(--card-bg);
            border-radius: 14px;
            padding: 28px 22px;
            text-align: center;
            box-shadow: 0 5px 15px var(--shadow-color);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: 1px solid var(--border-color);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .panel-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px var(--hover-shadow);
            border-color: var(--primary-color);
        }
        
        .panel-icon {
            font-size: 2.8rem;
            margin-bottom: 18px;
            color: var(--primary-color);
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.1));
        }
        
        .panel-card h3 {
            font-size: 1.4rem;
            margin-bottom: 12px;
            color: var(--text-color);
            font-weight: 700;
        }
        
        .panel-card p {
            color: #444444;
            font-size: 0.95rem;
            line-height: 1.6;
            font-weight: 400;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            overflow-y: auto;
            backdrop-filter: blur(3px);
        }
        
        .modal-content {
            background-color: var(--card-bg);
            margin: 40px auto;
            padding: 35px;
            border-radius: 18px;
            width: 92%;
            max-width: 850px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            position: relative;
            animation: modalAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid var(--border-color);
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: translateY(-60px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 18px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .modal-header h2 {
            color: var(--primary-color);
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .close-modal {
            font-size: 2rem;
            cursor: pointer;
            color: #666666;
            transition: all 0.3s ease;
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-modal:hover {
            color: var(--danger-color);
            background-color: rgba(220, 53, 69, 0.1);
            transform: rotate(90deg);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: var(--text-color);
            font-size: 1.05rem;
        }
        
        .form-control {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            font-size: 1.05rem;
            transition: all 0.3s ease;
            background-color: var(--bottom-bg);
            color: var(--text-color);
            font-weight: 500;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 119, 255, 0.2);
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            letter-spacing: 0.3px;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), #0066EE);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 119, 255, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #0066EE, #0055CC);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 119, 255, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color), #23963D);
            color: white;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #23963D, #1E7E34);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #C82333);
            color: white;
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #C82333, #BD2130);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(220, 53, 69, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #E0A800);
            color: #000000;
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.3);
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #E0A800, #D39E00);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.4);
        }
        
        .btn-back {
            background: linear-gradient(135deg, #6C757D, #5A6268);
            color: white;
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-back:hover {
            background: linear-gradient(135deg, #5A6268, #495057);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(108, 117, 125, 0.4);
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 25px;
        }
        
        /* تصميم جديد للصفوف - حقلين جنباً إلى جنب */
        .expense-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 249, 250, 0.9));
            padding: 15px;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .expense-row:hover {
            border-color: var(--primary-color);
            box-shadow: 0 5px 15px rgba(0, 119, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .expense-row-header {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--primary-color);
            font-weight: 700;
            color: var(--primary-color);
            background: linear-gradient(135deg, rgba(0, 119, 255, 0.1), rgba(0, 119, 255, 0.05));
            padding: 15px;
            border-radius: 10px;
        }
        
        .expense-name {
            flex: 3;
        }
        
        .expense-amount {
            flex: 2;
        }
        
        .expense-rows-container {
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.02);
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid var(--border-color);
        }
        
        .stats-container {
            background: linear-gradient(135deg, rgba(0, 119, 255, 0.12), rgba(0, 119, 255, 0.08));
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid rgba(0, 119, 255, 0.2);
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .stats-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 1.15rem;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0, 119, 255, 0.1);
        }
        
        .stats-row:last-child {
            margin-bottom: 0;
            border-bottom: none;
        }
        
        .stats-label {
            font-weight: 700;
            color: var(--text-color);
        }
        
        .stats-value {
            font-weight: 800;
            color: var(--primary-color);
            font-size: 1.2rem;
        }
        
        .empty-state {
            text-align: center;
            padding: 45px 25px;
            color: #666666;
            font-size: 1.15rem;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.03), rgba(0, 0, 0, 0.01));
            border-radius: 12px;
            margin: 25px 0;
            border: 2px dashed var(--border-color);
        }
        
        .empty-state i {
            font-size: 3.5rem;
            margin-bottom: 18px;
            color: #AAAAAA;
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.1));
        }
        
        .country-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
            gap: 18px;
            margin: 25px 0;
        }
        
        .country-card {
            background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA);
            border-radius: 12px;
            padding: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            border: 2px solid var(--border-color);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 4px 10px var(--shadow-color);
            cursor: pointer;
            position: relative;
        }
        
        .country-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px var(--hover-shadow);
            border-color: var(--primary-color);
        }
        
        .country-card.selected {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(0, 119, 255, 0.1), rgba(0, 119, 255, 0.05));
            box-shadow: 0 8px 20px rgba(0, 119, 255, 0.3);
        }
        
        .country-card.selected::after {
            content: "✓";
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: var(--primary-color);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 3px 8px rgba(0, 119, 255, 0.5);
        }
        
        .country-flag {
            width: 70px;
            height: 46px;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 12px;
            border: 2px solid var(--border-color);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        }
        
        .selected-currency {
            background: linear-gradient(135deg, rgba(0, 119, 255, 0.15), rgba(0, 119, 255, 0.1));
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--primary-color);
            text-align: center;
            display: none;
        }
        
        .selected-currency.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .selected-flag {
            width: 100px;
            height: 65px;
            object-fit: cover;
            border-radius: 8px;
            margin: 15px auto;
            border: 3px solid var(--primary-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .social-links {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin: 25px 0;
        }
        
        .social-link {
            display: flex;
            align-items: center;
            gap: 18px;
            padding: 18px;
            background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA);
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-color);
            border: 2px solid var(--border-color);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 4px 10px var(--shadow-color);
        }
        
        .social-link:hover {
            background: linear-gradient(135deg, rgba(0, 119, 255, 0.1), rgba(0, 119, 255, 0.05));
            border-color: var(--primary-color);
            transform: translateX(-5px);
            box-shadow: 0 8px 20px var(--hover-shadow);
        }
        
        .social-icon {
            font-size: 1.8rem;
            width: 35px;
            text-align: center;
        }
        
        .social-link .fa-youtube { color: #FF0000; }
        .social-link .fa-whatsapp { color: #25D366; }
        .social-link .fa-telegram { color: #0088CC; }
        .social-link .fa-instagram { color: #E4405F; }
        .social-link .fa-twitter { color: #1DA1F2; }
        
        .color-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 25px 0;
            justify-content: center;
        }
        
        .color-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .color-box {
            width: 70px;
            height: 70px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        .color-box:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .color-box.selected {
            border-color: var(--text-color);
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        .giver-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA);
            border-radius: 12px;
            margin-bottom: 12px;
            border: 2px solid var(--border-color);
            box-shadow: 0 4px 10px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .giver-item:hover {
            transform: translateX(-5px);
            box-shadow: 0 8px 18px var(--hover-shadow);
        }
        
        .hidden {
            display: none;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            margin-top: 50px;
            color: #555555;
            font-size: 0.95rem;
            border-top: 2px solid var(--border-color);
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .phone-link {
            text-decoration: none;
            color: inherit;
            display: inline-block;
            width: 100%;
        }
        
        .phone-link:hover .btn-primary {
            transform: translateY(-3px);
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
                gap: 20px;
            }
            
            .modal-content {
                width: 96%;
                padding: 25px;
                margin: 20px auto;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .expense-row {
                flex-direction: column;
                gap: 12px;
            }
            
            .expense-row-header {
                flex-direction: column;
                gap: 8px;
            }
            
            .expense-name, .expense-amount {
                width: 100%;
            }
            
            .country-grid {
                grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .company-info h1 {
                font-size: 1.8rem;
            }
            
            .panel-card h3 {
                font-size: 1.2rem;
            }
            
            .modal-header h2 {
                font-size: 1.6rem;
            }
            
            .country-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="company-info">
                <h1>Master Taha</h1>
                <p>شركة رقمية لتطوير مواقع ويب</p>
                <p>المدير العام: ChatGPT</p>
                <p>المدير التنفيذي: Deep Seek</p>
                <p>صاحب القرار: سيد رئيس تنفيذي طه زيات</p>
                <div class="mplan-badge">مخطط رقم: MTPLAN0001</div>
            </div>
            <h2>دفتر المصروف الذكي</h2>
            <p>مشروع رقم: MT-0001 | إصدار: V.1.0.0</p>
        </header>
        
        <main>
            <div class="dashboard">
                <!-- لوحة تسجيل مصروف -->
                <div class="panel-card" onclick="openPanel('expense-registration')">
                    <div class="panel-icon"><i class="fas fa-file-invoice-dollar"></i></div>
                    <h3>لوحة تسجيل مصروف</h3>
                    <p>تسجيل المصروفات اليومية وحساب الإحصائيات</p>
                </div>
                
                <!-- لوحة أوراق مصروف محفوظة -->
                <div class="panel-card" onclick="openPanel('saved-expenses')">
                    <div class="panel-icon"><i class="fas fa-save"></i></div>
                    <h3>لوحة أوراق مصروف محفوظة</h3>
                    <p>عرض وتعديل وحذف أوراق المصروف المحفوظة</p>
                </div>
                
                <!-- لوحة أوراق مصروف محذوفة -->
                <div class="panel-card" onclick="openPanel('deleted-expenses')">
                    <div class="panel-icon"><i class="fas fa-trash"></i></div>
                    <h3>لوحة أوراق مصروف محذوفة</h3>
                    <p>استعادة أو حذف نهائي لأوراق المصروف المحذوفة</p>
                </div>
                
                <!-- لوحة تعيين المعطين -->
                <div class="panel-card" onclick="openPanel('assign-givers')">
                    <div class="panel-icon"><i class="fas fa-hand-holding-usd"></i></div>
                    <h3>لوحة تعيين المعطين</h3>
                    <p>إدارة بيانات المعطين والمبالغ المعطاة</p>
                </div>
                
                <!-- لوحة تعيين العملة -->
                <div class="panel-card" onclick="openPanel('assign-currency')">
                    <div class="panel-icon"><i class="fas fa-coins"></i></div>
                    <h3>لوحة تعيين العملة</h3>
                    <p>اختيار العملة المناسبة من بين العملات العربية</p>
                </div>
                
                <!-- لوحة إعدادات موقع -->
                <div class="panel-card" onclick="openPanel('site-settings')">
                    <div class="panel-icon"><i class="fas fa-cog"></i></div>
                    <h3>لوحة إعدادات موقع</h3>
                    <p>تخصيص ألوان الموقع والإعدادات العامة</p>
                </div>
                
                <!-- لوحة تفاصيل موقع -->
                <div class="panel-card" onclick="openPanel('site-details')">
                    <div class="panel-icon"><i class="fas fa-info-circle"></i></div>
                    <h3>لوحة تفاصيل موقع</h3>
                    <p>عرض معلومات المشروع وأرقام الإصدار</p>
                </div>
                
                <!-- لوحة تواصل مع شركة -->
                <div class="panel-card" onclick="openPanel('company-contact')">
                    <div class="panel-icon"><i class="fas fa-headset"></i></div>
                    <h3>لوحة تواصل مع شركة</h3>
                    <p>اتصال ومراسلة شركة Master Taha</p>
                </div>
            </div>
        </main>
        
        <footer>
            <p>© 2023 Master Taha - جميع الحقوق محفوظة</p>
            <p>هذا الموقع مبني حسب مخطط رقم MTPLAN0001</p>
        </footer>
    </div>
    
    <!-- نافذة لوحة تسجيل مصروف -->
    <div id="expense-registration-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة تسجيل مصروف</h2>
                <button class="close-modal" onclick="closeModal('expense-registration-modal')">&times;</button>
            </div>
            
            <div class="form-group">
                <label>شاشة ورق مصروف اليومي</label>
                <button class="btn btn-primary" onclick="setTodayDate()">
                    <i class="fas fa-calendar-alt"></i> تعيين تاريخ اليوم
                </button>
                <input type="date" id="expense-date" class="form-control" style="margin-top: 15px;">
            </div>
            
            <div class="expense-row-header">
                <div class="expense-name">اسم مصروف</div>
                <div class="expense-amount">مبلغ مصروف</div>
            </div>
            
            <div class="expense-rows-container" id="expense-rows-container">
                <!-- سيتم إضافة 10 صفوف مبدئية هنا ديناميكيًا -->
            </div>
            
            <div class="stats-container">
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-color);">الإحصائيات</h3>
                <div class="stats-row">
                    <span class="stats-label">المبلغ المعطى:</span>
                    <span class="stats-value" id="total-given">0</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">المبلغ المصروف:</span>
                    <span class="stats-value" id="total-expense">0</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">المبلغ المتبقي:</span>
                    <span class="stats-value" id="remaining-amount">0</span>
                </div>
            </div>
            
            <div class="form-group">
                <label>شاشة المعطين تم تعيين</label>
                <div id="givers-list" class="empty-state">
                    <i class="fas fa-users-slash"></i>
                    <p>حتى الآن لا يوجد أي معطي مضاف حاليا</p>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="saveExpensePaper()">
                    <i class="fas fa-save"></i> حفظ ورق
                </button>
                <button class="btn btn-primary" onclick="addExpenseRow()">
                    <i class="fas fa-plus"></i> إضافة سطر
                </button>
                <button class="btn btn-danger" onclick="deleteExpenseRow()">
                    <i class="fas fa-minus"></i> حذف سطر
                </button>
                <button class="btn btn-warning" onclick="openPanel('assign-givers')">
                    <i class="fas fa-user-tag"></i> تعيين معطين
                </button>
                <button class="btn btn-back" onclick="closeModal('expense-registration-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة أوراق مصروف محفوظة -->
    <div id="saved-expenses-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة أوراق مصروف محفوظة</h2>
                <button class="close-modal" onclick="closeModal('saved-expenses-modal')">&times;</button>
            </div>
            
            <div id="saved-expenses-list" class="empty-state">
                <i class="fas fa-inbox"></i>
                <p>حتى الآن لا يوجد ورق مصروف محفوظ</p>
            </div>
            
            <div class="button-group">
                <button class="btn btn-danger" onclick="deleteSavedExpense()">
                    <i class="fas fa-trash"></i> حذف
                </button>
                <button class="btn btn-warning" onclick="editSavedExpense()">
                    <i class="fas fa-edit"></i> تعديل
                </button>
                <button class="btn btn-secondary" onclick="saveEditedExpense()">
                    <i class="fas fa-save"></i> حفظ
                </button>
                <button class="btn btn-primary" onclick="reviewExpense()">
                    <i class="fas fa-eye"></i> مراجعة
                </button>
                <button class="btn btn-back" onclick="closeModal('saved-expenses-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة أوراق مصروف محذوفة -->
    <div id="deleted-expenses-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة أوراق مصروف محذوفة</h2>
                <button class="close-modal" onclick="closeModal('deleted-expenses-modal')">&times;</button>
            </div>
            
            <div id="deleted-expenses-list" class="empty-state">
                <i class="fas fa-trash-alt"></i>
                <p>حتى الآن لا يوجد ورق مصروف محذوف</p>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="restoreExpense()">
                    <i class="fas fa-undo"></i> استعادة
                </button>
                <button class="btn btn-danger" onclick="permanentDeleteExpense()">
                    <i class="fas fa-fire"></i> حذف نهائي
                </button>
                <button class="btn btn-back" onclick="closeModal('deleted-expenses-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة تعيين المعطين -->
    <div id="assign-givers-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة تعيين المعطين</h2>
                <button class="close-modal" onclick="closeModal('assign-givers-modal')">&times;</button>
            </div>
            
            <div class="form-group">
                <label>اسم معطي:</label>
                <input type="text" id="giver-name" class="form-control" placeholder="أدخل اسم المعطي">
            </div>
            
            <div class="form-group">
                <label>مبلغ المعطى:</label>
                <input type="number" id="giver-amount" class="form-control" placeholder="أدخل المبلغ المعطى">
            </div>
            
            <div id="givers-container">
                <!-- سيتم عرض المعطين هنا ديناميكيًا -->
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="addGiver()">
                    <i class="fas fa-plus"></i> إضافة
                </button>
                <button class="btn btn-warning" onclick="editGiver()">
                    <i class="fas fa-edit"></i> تعديل
                </button>
                <button class="btn btn-secondary" onclick="saveGiverEdit()">
                    <i class="fas fa-save"></i> حفظ
                </button>
                <button class="btn btn-danger" onclick="deleteGiver()">
                    <i class="fas fa-trash"></i> حذف
                </button>
                <button class="btn btn-back" onclick="closeModal('assign-givers-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة تعيين العملة -->
    <div id="assign-currency-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة تعيين العملة</h2>
                <button class="close-modal" onclick="closeModal('assign-currency-modal')">&times;</button>
            </div>
            
            <p style="text-align: center; margin-bottom: 25px; font-size: 1.1rem; font-weight: 600;">شاشة تعيين عملة بين 22 دولة عربية</p>
            
            <div id="selected-currency-container" class="selected-currency">
                <h3 style="color: var(--primary-color); margin-bottom: 10px;">العملة المختارة</h3>
                <img id="selected-flag" src="" alt="العلم المختار" class="selected-flag">
                <p id="selected-country-name" style="font-weight: 700; font-size: 1.2rem;"></p>
                <p id="selected-currency-name" style="color: #666; margin-top: 5px;"></p>
            </div>
            
            <div class="country-grid" id="countries-container">
                <!-- سيتم عرض الدول هنا ديناميكيًا -->
            </div>
            
            <div class="button-group" style="justify-content: center;">
                <button class="btn btn-secondary" onclick="saveSelectedCurrency()">
                    <i class="fas fa-save"></i> حفظ العلم المختار
                </button>
                <button class="btn btn-back" onclick="closeModal('assign-currency-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة إعدادات موقع -->
    <div id="site-settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة إعدادات موقع</h2>
                <button class="close-modal" onclick="closeModal('site-settings-modal')">&times;</button>
            </div>
            
            <p style="text-align: center; margin-bottom: 25px; font-size: 1.1rem; font-weight: 600;">شاشة تعيين ألوان الموقع</p>
            
            <div class="color-picker">
                <div class="color-option">
                    <div class="color-box selected" style="background-color: #0077FF;" onclick="selectColor('top-bg', '#0077FF')"></div>
                    <span style="font-weight: 600;">لون خلفية أعلى</span>
                </div>
                
                <div class="color-option">
                    <div class="color-box selected" style="background-color: #FFFFFF;" onclick="selectColor('bottom-bg', '#FFFFFF')"></div>
                    <span style="font-weight: 600;">لون خلفية أسفل</span>
                </div>
                
                <div class="color-option">
                    <div class="color-box selected" style="background-color: #000000;" onclick="selectColor('text-color', '#000000')"></div>
                    <span style="font-weight: 600;">لون الخطوط</span>
                </div>
            </div>
            
            <div class="color-picker">
                <div class="color-option">
                    <div class="color-box" style="background-color: #4CAF50;" onclick="selectColor('top-bg', '#4CAF50')"></div>
                    <span>أخضر</span>
                </div>
                
                <div class="color-option">
                    <div class="color-box" style="background-color: #FF9800;" onclick="selectColor('top-bg', '#FF9800')"></div>
                    <span>برتقالي</span>
                </div>
                
                <div class="color-option">
                    <div class="color-box" style="background-color: #9C27B0;" onclick="selectColor('top-bg', '#9C27B0')"></div>
                    <span>بنفسجي</span>
                </div>
                
                <div class="color-option">
                    <div class="color-box" style="background-color: #F44336;" onclick="selectColor('top-bg', '#F44336')"></div>
                    <span>أحمر</span>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="applyStyle()">
                    <i class="fas fa-check"></i> تطبيق نمط
                </button>
                <button class="btn btn-warning" onclick="resetStyle()">
                    <i class="fas fa-undo"></i> إعادة تعيين
                </button>
                <button class="btn btn-back" onclick="closeModal('site-settings-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة تفاصيل موقع -->
    <div id="site-details-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة تفاصيل موقع</h2>
                <button class="close-modal" onclick="closeModal('site-details-modal')">&times;</button>
            </div>
            
            <div style="text-align: center; padding: 35px 0;">
                <h3 style="color: var(--primary-color); margin-bottom: 25px; font-size: 1.8rem;">دفتر المصروف الذكي</h3>
                
                <div style="background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA); padding: 25px; border-radius: 12px; margin: 25px 0; border: 2px solid var(--border-color); box-shadow: 0 5px 15px var(--shadow-color);">
                    <p style="margin-bottom: 12px; font-size: 1.15rem; font-weight: 600;"><strong>اسم المشروع:</strong> دفتر مصروف ذكي</p>
                    <p style="margin-bottom: 12px; font-size: 1.15rem; font-weight: 600;"><strong>رقم المشروع:</strong> MT-0001</p>
                    <p style="margin-bottom: 12px; font-size: 1.15rem; font-weight: 600;"><strong>رقم الإصدار:</strong> V.1.0.0</p>
                    <p style="margin-bottom: 12px; font-size: 1.15rem; font-weight: 600;"><strong>مخطط رقم:</strong> MTPLAN0001</p>
                </div>
                
                <p style="margin-top: 25px; color: #666; font-size: 1.05rem;">تم تطوير هذا الموقع حسب مخطط MTPLAN0001 الكامل والنهائي</p>
            </div>
            
            <div class="button-group" style="justify-content: center;">
                <button class="btn btn-back" onclick="closeModal('site-details-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>
    
    <!-- نافذة لوحة تواصل مع شركة -->
    <div id="company-contact-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>لوحة تواصل مع شركة</h2>
                <button class="close-modal" onclick="closeModal('company-contact-modal')">&times;</button>
            </div>
            
            <div style="margin: 25px 0;">
                <h3 style="margin-bottom: 20px; color: var(--primary-color); font-size: 1.5rem;">أرقام الهاتف:</h3>
                
                <div style="background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid var(--border-color); box-shadow: 0 5px 15px var(--shadow-color);">
                    <p style="margin-bottom: 15px; font-size: 1.15rem; font-weight: 600;"><strong>رقم الهاتف الأول:</strong> 0959570730</p>
                    <a href="tel:+963959570730" class="phone-link">
                        <button class="btn btn-primary">
                            <i class="fas fa-phone"></i> اتصال مباشر
                        </button>
                    </a>
                </div>
                
                <div style="background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA); padding: 20px; border-radius: 12px; margin-bottom: 30px; border: 2px solid var(--border-color); box-shadow: 0 5px 15px var(--shadow-color);">
                    <p style="margin-bottom: 15px; font-size: 1.15rem; font-weight: 600;"><strong>رقم الهاتف الثاني:</strong> 0982944894</p>
                    <a href="tel:+963982944894" class="phone-link">
                        <button class="btn btn-primary">
                            <i class="fas fa-phone"></i> اتصال مباشر
                        </button>
                    </a>
                </div>
                
                <h3 style="margin-bottom: 20px; color: var(--primary-color); font-size: 1.5rem;">روابط قنوات التواصل الاجتماعي:</h3>
                
                <div class="social-links">
                    <a href="https://youtube.com/@mastertaha-f2m?si=Y6sA-6zdYDuvda3I" target="_blank" class="social-link">
                        <div class="social-icon"><i class="fab fa-youtube"></i></div>
                        <div>
                            <strong style="font-size: 1.1rem;">يوتيوب</strong>
                            <p style="font-size: 0.95rem; color: #666; margin-top: 5px;">youtube.com/@mastertaha-f2m</p>
                        </div>
                    </a>
                    
                    <a href="https://whatsapp.com/channel/0029VbCYfmm9sBI6squLAT0f" target="_blank" class="social-link">
                        <div class="social-icon"><i class="fab fa-whatsapp"></i></div>
                        <div>
                            <strong style="font-size: 1.1rem;">واتساب</strong>
                            <p style="font-size: 0.95rem; color: #666; margin-top: 5px;">whatsapp.com/channel/mastertaha</p>
                        </div>
                    </a>
                    
                    <a href="https://t.me/boost/mastertaha2" target="_blank" class="social-link">
                        <div class="social-icon"><i class="fab fa-telegram"></i></div>
                        <div>
                            <strong style="font-size: 1.1rem;">تلغرام</strong>
                            <p style="font-size: 0.95rem; color: #666; margin-top: 5px;">t.me/boost/mastertaha2</p>
                        </div>
                    </a>
                    
                    <a href="https://www.instagram.com/mastertahamt" target="_blank" class="social-link">
                        <div class="social-icon"><i class="fab fa-instagram"></i></div>
                        <div>
                            <strong style="font-size: 1.1rem;">إنستغرام</strong>
                            <p style="font-size: 0.95rem; color: #666; margin-top: 5px;">instagram.com/mastertahamt</p>
                        </div>
                    </a>
                    
                    <a href="https://x.com/MasterTaha34396" target="_blank" class="social-link">
                        <div class="social-icon"><i class="fab fa-twitter"></i></div>
                        <div>
                            <strong style="font-size: 1.1rem;">تويتر</strong>
                            <p style="font-size: 0.95rem; color: #666; margin-top: 5px;">x.com/MasterTaha34396</p>
                        </div>
                    </a>
                </div>
                
                <h3 style="margin: 30px 0 20px; color: var(--primary-color); font-size: 1.5rem;">أوقات الدوام:</h3>
                
                <div style="background: linear-gradient(135deg, var(--bottom-bg), #F8F9FA); padding: 20px; border-radius: 12px; border: 2px solid var(--border-color); box-shadow: 0 5px 15px var(--shadow-color);">
                    <p style="margin-bottom: 8px; font-size: 1.1rem; font-weight: 600;"><strong>من الساعة 5:00 مساء حتى 10:00 مساء</strong></p>
                    <p style="margin-bottom: 8px; font-size: 1.1rem;"><strong>أيام العمل:</strong> الأحد والخميس</p>
                    <p style="font-size: 1.1rem;"><strong>الإجازة:</strong> الجمعة والسبت</p>
                </div>
            </div>
            
            <div class="button-group" style="justify-content: center;">
                <button class="btn btn-back" onclick="closeModal('company-contact-modal')">
                    <i class="fas fa-arrow-right"></i> رجوع
                </button>
            </div>
        </div>
    </div>

    <script>
        // بيانات التطبيق
        let expenseRows = 10;
        let givers = [];
        let savedExpenses = [];
        let deletedExpenses = [];
        let selectedGiverIndex = -1;
        let selectedCountry = null;
        let selectedColor = {
            'top-bg': '#0077FF',
            'bottom-bg': '#FFFFFF',
            'text-color': '#000000'
        };
        
        // بيانات الدول العربية
        const arabCountries = [
            { name: "السعودية", flag: "https://flagcdn.com/w320/sa.png", currency: "الريال السعودي", code: "sa" },
            { name: "الإمارات", flag: "https://flagcdn.com/w320/ae.png", currency: "الدرهم الإماراتي", code: "ae" },
            { name: "قطر", flag: "https://flagcdn.com/w320/qa.png", currency: "الريال القطري", code: "qa" },
            { name: "الكويت", flag: "https://flagcdn.com/w320/kw.png", currency: "الدينار الكويتي", code: "kw" },
            { name: "عمان", flag: "https://flagcdn.com/w320/om.png", currency: "الريال العماني", code: "om" },
            { name: "البحرين", flag: "https://flagcdn.com/w320/bh.png", currency: "الدينار البحريني", code: "bh" },
            { name: "اليمن", flag: "https://flagcdn.com/w320/ye.png", currency: "الريال اليمني", code: "ye" },
            { name: "مصر", flag: "https://flagcdn.com/w320/eg.png", currency: "الجنيه المصري", code: "eg" },
            { name: "السودان", flag: "https://flagcdn.com/w320/sd.png", currency: "الجنيه السوداني", code: "sd" },
            { name: "ليبيا", flag: "https://flagcdn.com/w320/ly.png", currency: "الدينار الليبي", code: "ly" },
            { name: "تونس", flag: "https://flagcdn.com/w320/tn.png", currency: "الدينار التونسي", code: "tn" },
            { name: "الجزائر", flag: "https://flagcdn.com/w320/dz.png", currency: "الدينار الجزائري", code: "dz" },
            { name: "المغرب", flag: "https://flagcdn.com/w320/ma.png", currency: "الدرهم المغربي", code: "ma" },
            { name: "موريتانيا", flag: "https://flagcdn.com/w320/mr.png", currency: "الأوقية الموريتانية", code: "mr" },
            { name: "سوريا", flag: "https://flagcdn.com/w320/sy.png", currency: "الليرة السورية", code: "sy" },
            { name: "لبنان", flag: "https://flagcdn.com/w320/lb.png", currency: "الليرة اللبنانية", code: "lb" },
            { name: "الأردن", flag: "https://flagcdn.com/w320/jo.png", currency: "الدينار الأردني", code: "jo" },
            { name: "العراق", flag: "https://flagcdn.com/w320/iq.png", currency: "الدينار العراقي", code: "iq" },
            { name: "فلسطين", flag: "https://flagcdn.com/w320/ps.png", currency: "الشيكل الإسرائيلي", code: "ps" },
            { name: "الصومال", flag: "https://flagcdn.com/w320/so.png", currency: "الشلن الصومالي", code: "so" },
            { name: "جيبوتي", flag: "https://flagcdn.com/w320/dj.png", currency: "الفرنك الجيبوتي", code: "dj" },
            { name: "جزر القمر", flag: "https://flagcdn.com/w320/km.png", currency: "الفرنك القمري", code: "km" }
        ];
        
        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            // تعيين تاريخ اليوم
            setTodayDate();
            
            // إنشاء 10 صفوف مبدئية مع حقلين جنباً إلى جنب
            initializeExpenseRows();
            
            // إنشاء قائمة الدول
            initializeCountries();
            
            // تحميل البيانات من التخزين المحلي إن وجدت
            loadFromLocalStorage();
            
            // تحديث الإحصائيات
            updateStatistics();
            
            // تحديث قائمة المعطين
            updateGiversList();
        });
        
        // وظائف فتح وإغلاق النوافذ
        function openPanel(panelName) {
            const modalId = `${panelName}-modal`;
            document.getElementById(modalId).style.display = 'block';
            
            // تحديث المحتوى بناءً على اللوحة المفتوحة
            if (panelName === 'expense-registration') {
                updateGiversDisplay();
            } else if (panelName === 'assign-currency') {
                updateSelectedCurrencyDisplay();
            }
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // وظائف لوحة تسجيل المصروف
        function setTodayDate() {
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('expense-date').value = formattedDate;
        }
        
        function initializeExpenseRows() {
            const container = document.getElementById('expense-rows-container');
            container.innerHTML = '';
            
            // إنشاء 10 صفوف مبدئية
            for (let i = 1; i <= 10; i++) {
                const row = document.createElement('div');
                row.className = 'expense-row';
                row.innerHTML = `
                    <div class="expense-name">
                        <input type="text" class="form-control expense-name-input" placeholder="اسم المصروف ${i}" oninput="updateStatistics()">
                    </div>
                    <div class="expense-amount">
                        <input type="number" class="form-control expense-amount-input" placeholder="مبلغ المصروف ${i}" oninput="updateStatistics()">
                    </div>
                `;
                container.appendChild(row);
            }
        }
        
        function addExpenseRow() {
            expenseRows++;
            const container = document.getElementById('expense-rows-container');
            
            const row = document.createElement('div');
            row.className = 'expense-row';
            row.innerHTML = `
                <div class="expense-name">
                    <input type="text" class="form-control expense-name-input" placeholder="اسم المصروف ${expenseRows}" oninput="updateStatistics()">
                </div>
                <div class="expense-amount">
                    <input type="number" class="form-control expense-amount-input" placeholder="مبلغ المصروف ${expenseRows}" oninput="updateStatistics()">
                </div>
            `;
            container.appendChild(row);
        }
        
        function deleteExpenseRow() {
            if (expenseRows > 1) {
                const container = document.getElementById('expense-rows-container');
                container.removeChild(container.lastChild);
                expenseRows--;
                updateStatistics();
            } else {
                alert('يجب أن يبقى سطر واحد على الأقل');
            }
        }
        
        function updateStatistics() {
            let totalExpense = 0;
            const amountInputs = document.querySelectorAll('.expense-amount-input');
            
            amountInputs.forEach(input => {
                const value = parseFloat(input.value) || 0;
                totalExpense += value;
            });
            
            let totalGiven = 0;
            givers.forEach(giver => {
                totalGiven += parseFloat(giver.amount) || 0;
            });
            
            const remaining = totalGiven - totalExpense;
            
            document.getElementById('total-given').textContent = totalGiven.toFixed(2);
            document.getElementById('total-expense').textContent = totalExpense.toFixed(2);
            document.getElementById('remaining-amount').textContent = remaining.toFixed(2);
            
            // تغيير لون المبلغ المتبقي إذا كان سالبًا
            const remainingElement = document.getElementById('remaining-amount');
            if (remaining < 0) {
                remainingElement.style.color = 'var(--danger-color)';
            } else {
                remainingElement.style.color = 'var(--primary-color)';
            }
            
            // تحديث قائمة المعطين
            updateGiversDisplay();
        }
        
        function updateGiversDisplay() {
            const giversList = document.getElementById('givers-list');
            
            if (givers.length > 0) {
                giversList.innerHTML = '';
                
                givers.forEach((giver, index) => {
                    const giverElement = document.createElement('div');
                    giverElement.className = 'giver-item';
                    giverElement.innerHTML = `
                        <div>
                            <strong>${giver.name}</strong>
                            <p style="color: #666; margin-top: 5px;">${parseFloat(giver.amount).toFixed(2)}</p>
                        </div>
                        <div>
                            <button class="btn btn-danger btn-sm" onclick="removeGiver(${index})" style="padding: 6px 12px; font-size: 0.9rem; border-radius: 8px;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    giversList.appendChild(giverElement);
                });
            } else {
                giversList.innerHTML = `
                    <i class="fas fa-users-slash"></i>
                    <p>حتى الآن لا يوجد أي معطي مضاف حاليا</p>
                `;
                giversList.className = 'empty-state';
            }
        }
        
        function saveExpensePaper() {
            const date = document.getElementById('expense-date').value;
            const expenseItems = [];
            
            const nameInputs = document.querySelectorAll('.expense-name-input');
            const amountInputs = document.querySelectorAll('.expense-amount-input');
            
            for (let i = 0; i < nameInputs.length; i++) {
                const name = nameInputs[i].value.trim();
                const amount = parseFloat(amountInputs[i].value) || 0;
                
                if (name || amount > 0) {
                    expenseItems.push({
                        name: name || `مصروف ${i+1}`,
                        amount: amount
                    });
                }
            }
            
            if (expenseItems.length === 0) {
                alert('يرجى إدخال مصروف واحد على الأقل');
                return;
            }
            
            const totalExpense = expenseItems.reduce((sum, item) => sum + item.amount, 0);
            const totalGiven = givers.reduce((sum, giver) => sum + parseFloat(giver.amount), 0);
            const remaining = totalGiven - totalExpense;
            
            const expensePaper = {
                id: Date.now(),
                date: date || new Date().toISOString().split('T')[0],
                items: expenseItems,
                givers: [...givers],
                totalGiven: totalGiven,
                totalExpense: totalExpense,
                remaining: remaining
            };
            
            savedExpenses.push(expensePaper);
            saveToLocalStorage();
            
            // إعادة تعيين الحقول
            document.querySelectorAll('.expense-name-input').forEach(input => input.value = '');
            document.querySelectorAll('.expense-amount-input').forEach(input => input.value = '');
            givers = [];
            updateStatistics();
            updateGiversDisplay();
            
            alert('تم حفظ ورق المصروف بنجاح في لوحة الأوراق المحفوظة');
        }
        
        // وظائف لوحة تعيين المعطين
        function addGiver() {
            const nameInput = document.getElementById('giver-name');
            const amountInput = document.getElementById('giver-amount');
            
            const name = nameInput.value.trim();
            const amount = amountInput.value.trim();
            
            if (!name) {
                alert('يرجى إدخال اسم المعطي');
                return;
            }
            
            if (!amount || isNaN(parseFloat(amount)) || parseFloat(amount) <= 0) {
                alert('يرجى إدخال مبلغ صحيح للمعطي');
                return;
            }
            
            givers.push({
                name: name,
                amount: parseFloat(amount)
            });
            
            nameInput.value = '';
            amountInput.value = '';
            
            updateGiversList();
            updateStatistics();
            saveToLocalStorage();
        }
        
        function updateGiversList() {
            const container = document.getElementById('givers-container');
            container.innerHTML = '';
            
            if (givers.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #888; padding: 20px;">لا يوجد معطين مضافين حالياً</p>';
                return;
            }
            
            givers.forEach((giver, index) => {
                const giverElement = document.createElement('div');
                giverElement.className = 'giver-item';
                giverElement.innerHTML = `
                    <div>
                        <strong>${giver.name}</strong>
                        <p style="color: #666; margin-top: 5px;">${parseFloat(giver.amount).toFixed(2)}</p>
                    </div>
                    <div>
                        <button class="btn btn-warning btn-sm" onclick="selectGiverForEdit(${index})" style="padding: 6px 12px; font-size: 0.9rem; border-radius: 8px; margin-right: 5px;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="removeGiver(${index})" style="padding: 6px 12px; font-size: 0.9rem; border-radius: 8px;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(giverElement);
            });
        }
        
        function selectGiverForEdit(index) {
            selectedGiverIndex = index;
            const giver = givers[index];
            
            document.getElementById('giver-name').value = giver.name;
            document.getElementById('giver-amount').value = giver.amount;
        }
        
        function editGiver() {
            if (selectedGiverIndex === -1) {
                alert('يرجى اختيار معطي للتعديل');
                return;
            }
            
            const nameInput = document.getElementById('giver-name');
            const amountInput = document.getElementById('giver-amount');
            
            const name = nameInput.value.trim();
            const amount = amountInput.value.trim();
            
            if (!name) {
                alert('يرجى إدخال اسم المعطي');
                return;
            }
            
            if (!amount || isNaN(parseFloat(amount)) || parseFloat(amount) <= 0) {
                alert('يرجى إدخال مبلغ صحيح للمعطي');
                return;
            }
            
            givers[selectedGiverIndex] = {
                name: name,
                amount: parseFloat(amount)
            };
            
            nameInput.value = '';
            amountInput.value = '';
            selectedGiverIndex = -1;
            
            updateGiversList();
            updateStatistics();
            saveToLocalStorage();
        }
        
        function saveGiverEdit() {
            editGiver();
        }
        
        function deleteGiver() {
            if (selectedGiverIndex === -1) {
                alert('يرجى اختيار معطي للحذف');
                return;
            }
            
            if (confirm('هل أنت متأكد من حذف هذا المعطي؟')) {
                givers.splice(selectedGiverIndex, 1);
                selectedGiverIndex = -1;
                
                document.getElementById('giver-name').value = '';
                document.getElementById('giver-amount').value = '';
                
                updateGiversList();
                updateStatistics();
                saveToLocalStorage();
            }
        }
        
        function removeGiver(index) {
            if (confirm('هل أنت متأكد من حذف هذا المعطي؟')) {
                givers.splice(index, 1);
                
                if (selectedGiverIndex === index) {
                    selectedGiverIndex = -1;
                    document.getElementById('giver-name').value = '';
                    document.getElementById('giver-amount').value = '';
                }
                
                updateGiversList();
                updateStatistics();
                saveToLocalStorage();
            }
        }
        
        // وظائف لوحة تعيين العملة
        function initializeCountries() {
            const container = document.getElementById('countries-container');
            container.innerHTML = '';
            
            arabCountries.forEach((country, index) => {
                const countryCard = document.createElement('div');
                countryCard.className = 'country-card';
                countryCard.setAttribute('data-index', index);
                countryCard.onclick = function() {
                    selectCountry(index);
                };
                
                countryCard.innerHTML = `
                    <img src="${country.flag}" alt="${country.name}" class="country-flag">
                    <h4 style="font-weight: 700; margin: 8px 0;">${country.name}</h4>
                    <p style="color: #666; margin-top: 5px; font-weight: 600;">${country.currency}</p>
                `;
                container.appendChild(countryCard);
            });
            
            // تحميل الدولة المختارة مسبقًا إن وجدت
            const savedCountry = localStorage.getItem('selectedCountry');
            if (savedCountry) {
                const country = JSON.parse(savedCountry);
                selectedCountry = country;
                updateSelectedCurrencyDisplay();
                
                // تحديد البطاقة المختارة
                const countryCards = document.querySelectorAll('.country-card');
                countryCards.forEach(card => {
                    const index = parseInt(card.getAttribute('data-index'));
                    if (arabCountries[index].name === country.name) {
                        card.classList.add('selected');
                    }
                });
            }
        }
        
        function selectCountry(index) {
            selectedCountry = arabCountries[index];
            
            // إزالة التحديد من جميع البطاقات
            const countryCards = document.querySelectorAll('.country-card');
            countryCards.forEach(card => {
                card.classList.remove('selected');
            });
            
            // إضافة التحديد للبطاقة المختارة
            const selectedCard = document.querySelector(`.country-card[data-index="${index}"]`);
            selectedCard.classList.add('selected');
            
            // تحديث عرض العملة المختارة
            updateSelectedCurrencyDisplay();
        }
        
        function updateSelectedCurrencyDisplay() {
            const container = document.getElementById('selected-currency-container');
            
            if (selectedCountry) {
                container.classList.add('active');
                document.getElementById('selected-flag').src = selectedCountry.flag;
                document.getElementById('selected-country-name').textContent = selectedCountry.name;
                document.getElementById('selected-currency-name').textContent = selectedCountry.currency;
            } else {
                container.classList.remove('active');
            }
        }
        
        function saveSelectedCurrency() {
            if (!selectedCountry) {
                alert('يرجى اختيار دولة أولاً');
                return;
            }
            
            localStorage.setItem('selectedCountry', JSON.stringify(selectedCountry));
            alert(`تم حفظ العلم والعملة: ${selectedCountry.name} - ${selectedCountry.currency}`);
        }
        
        // وظائف لوحة إعدادات الموقع
        function selectColor(type, color) {
            selectedColor[type] = color;
            
            // تحديث المربعات المحددة
            document.querySelectorAll('.color-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            // تطبيق التحديد على الصناديق المختارة
            document.querySelectorAll(`.color-box[style*="${color}"]`).forEach(box => {
                box.classList.add('selected');
            });
        }
        
        function applyStyle() {
            document.documentElement.style.setProperty('--top-bg', selectedColor['top-bg']);
            document.documentElement.style.setProperty('--bottom-bg', selectedColor['bottom-bg']);
            document.documentElement.style.setProperty('--text-color', selectedColor['text-color']);
            
            // حفظ الإعدادات
            localStorage.setItem('siteColors', JSON.stringify(selectedColor));
            
            alert('تم تطبيق النمط الجديد بنجاح');
        }
        
        function resetStyle() {
            selectedColor = {
                'top-bg': '#0077FF',
                'bottom-bg': '#FFFFFF',
                'text-color': '#000000'
            };
            
            document.documentElement.style.setProperty('--top-bg', selectedColor['top-bg']);
            document.documentElement.style.setProperty('--bottom-bg', selectedColor['bottom-bg']);
            document.documentElement.style.setProperty('--text-color', selectedColor['text-color']);
            
            // حفظ الإعدادات
            localStorage.setItem('siteColors', JSON.stringify(selectedColor));
            
            // تحديث المربعات المحددة
            document.querySelectorAll('.color-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            // تحديد المربعات الافتراضية
            document.querySelectorAll('.color-box[style*="#0077FF"], .color-box[style*="#FFFFFF"], .color-box[style*="#000000"]').forEach(box => {
                box.classList.add('selected');
            });
            
            alert('تم إعادة تعيين الألوان إلى الإعدادات الافتراضية');
        }
        
        // وظائف لوحة أوراق المصروف المحفوظة
        function deleteSavedExpense() {
            // في تطبيق حقيقي، سيتم عرض قائمة بالمصروفات المحفوظة واختيار واحد للحذف
            alert('في التطبيق الكامل، سيتم عرض قائمة بالمصروفات المحفوظة واختيار واحد للحذف');
        }
        
        function editSavedExpense() {
            alert('في التطبيق الكامل، سيتم عرض قائمة بالمصروفات المحفوظة واختيار واحد للتعديل');
        }
        
        function saveEditedExpense() {
            alert('في التطبيق الكامل، سيتم حفظ التعديلات على المصروف المحدد');
        }
        
        function reviewExpense() {
            alert('في التطبيق الكامل، سيتم عرض تفاصيل المصروف المحدد');
        }
        
        // وظائف لوحة أوراق المصروف المحذوفة
        function restoreExpense() {
            alert('في التطبيق الكامل، سيتم عرض قائمة بالمصروفات المحذوفة واختيار واحد للاستعادة');
        }
        
        function permanentDeleteExpense() {
            alert('في التطبيق الكامل، سيتم عرض قائمة بالمصروفات المحذوفة واختيار واحد للحذف النهائي');
        }
        
        // وظائف التخزين المحلي
        function saveToLocalStorage() {
            const data = {
                givers: givers,
                savedExpenses: savedExpenses,
                deletedExpenses: deletedExpenses
            };
            
            localStorage.setItem('smartExpenseBook', JSON.stringify(data));
        }
        
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('smartExpenseBook');
            
            if (savedData) {
                const data = JSON.parse(savedData);
                givers = data.givers || [];
                savedExpenses = data.savedExpenses || [];
                deletedExpenses = data.deletedExpenses || [];
                
                updateGiversList();
            }
            
            // تحميل ألوان الموقع
            const savedColors = localStorage.getItem('siteColors');
            if (savedColors) {
                selectedColor = JSON.parse(savedColors);
                
                document.documentElement.style.setProperty('--top-bg', selectedColor['top-bg']);
                document.documentElement.style.setProperty('--bottom-bg', selectedColor['bottom-bg']);
                document.documentElement.style.setProperty('--text-color', selectedColor['text-color']);
                
                // تحديث المربعات المحددة
                document.querySelectorAll('.color-box').forEach(box => {
                    box.classList.remove('selected');
                });
                
                // تحديد المربعات المحفوظة
                Object.values(selectedColor).forEach(color => {
                    document.querySelectorAll(`.color-box[style*="${color}"]`).forEach(box => {
                        box.classList.add('selected');
                    });
                });
            }
        }
        
        // إغلاق النوافذ عند النقر خارجها
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };
        
        // إغلاق النوافذ بالزر Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    modal.style.display = 'none';
                });
            }
        });
    </script>
</body>
    </html>
